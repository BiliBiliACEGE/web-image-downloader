<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title data-i18n="optTitle"></title>
  <link rel="stylesheet" href="styles/options.css"/>
</head>
<body>
  <div class="container">
    <header class="header">
      <img src="../icons/48.png" alt="Logo" class="logo"/>
      <h1 class="title" data-i18n="extName"></h1>
    </header>

    <nav class="nav-tabs">
      <button class="nav-tab active" data-tab="general" data-i18n="optGeneral"></button>
      <button class="nav-tab" data-tab="rules" data-i18n="optRules"></button>
      <button class="nav-tab" data-tab="advanced" data-i18n="optAdvanced"></button>
      <button class="nav-tab" data-tab="about" data-i18n="optAbout"></button>
    </nav>

    <main class="main">
      <!-- 常规设置 -->
      <div id="general" class="tab-content active">
        <section class="section">
          <h2 class="section-title" data-i18n="optGeneral"></h2>

          <div class="form-group">
            <label class="form-label" data-i18n="optDownloadMode"></label>
            <select id="downloadMode" class="form-select">
              <option value="direct" data-i18n="optDirect"></option>
              <option value="newTab" data-i18n="optNewTab"></option>
              <option value="batch" data-i18n="optBatch"></option>
              <option value="copy" data-i18n="optCopy"></option>
            </select>
            <p class="form-help" data-i18n="optDownloadModeHelp"></p>
          </div>

        <div class="form-group">
        <label class="form-label" data-i18n="optLanguage"></label>
        <select id="languageSelect" class="form-select">
            <option value="auto" data-i18n="optLangAuto"></option>
            <option value="en" data-i18n="optLangEN"></option>
            <option value="zh_CN" data-i18n="optLangZHCN"></option>
            <option value="zh_TW" data-i18n="optLangZHTW"></option>
        </select>
        <p class="form-help" data-i18n="optLangReload" style="color:#d13438;margin-top:4px;display:none;" id="langHelp"></p>
        </div>

          <div class="form-group">
            <label class="form-label" data-i18n="optFileNameTpl"></label>
            <input type="text" id="fileNameTemplate" class="form-input" placeholder="{original}"/>
            <p class="form-help" data-i18n="optFileNameTplHelp"></p>
          </div>
        <div id="customNamingGroup" class="form-group" style="display:none;">
            <label class="form-label" data-i18n="optCustomPattern"></label>
            <input type="text" id="customNaming" class="form-input" placeholder="{domain}_{timestamp}_{index}"/>
            <p class="form-help" data-i18n="optCustomPatternHelp"></p>
        </div>

          <div class="form-group">
            <label class="form-label" data-i18n="optMaxFileLen"></label>
            <input type="number" id="maxFileNameLength" class="form-input" min="10" max="255" value="50"/>
            <p class="form-help" data-i18n="optMaxFileLenHelp"></p>
          </div>

          <div class="form-group">
            <label class="form-label" data-i18n="optNamingPattern"></label>
            <select id="namingPattern" class="form-select">
              <option value="original" data-i18n="optOriginal"></option>
              <option value="timestamp" data-i18n="optTimestamp"></option>
              <option value="domain" data-i18n="optDomain"></option>
              <option value="custom" data-i18n="optCustom"></option>
            </select>
          </div>

          <div class="form-group">
            <label class="form-checkbox">
              <input type="checkbox" id="showNotifications"/>
              <span class="checkmark"></span>
              <span data-i18n="optShowNotify"></span>
            </label>
          </div>

          <div class="form-group">
            <label class="form-checkbox">
              <input type="checkbox" id="enableContextMenu"/>
              <span class="checkmark"></span>
              <span data-i18n="optContextMenu"></span>
            </label>
          </div>

          <div class="form-group">
            <label class="form-checkbox">
              <input type="checkbox" id="autoCloseTab"/>
              <span class="checkmark"></span>
              <span data-i18n="optAutoClose"></span>
            </label>
          </div>
        </section>
      </div>

      <!-- 规则设置 -->
      <div id="rules" class="tab-content">
        <section class="section">
        <div class="section-header">
        <h2 class="section-title" data-i18n="optRules"></h2>
        <button id="addRule" class="btn btn-primary" data-i18n="optAddRule"></button>
      </div>
      <div id="rulesContainer"></div>
    </section>

        <section class="section">
          <h2 class="section-title" data-i18n="optRuleTest"></h2>
          <div class="test-area">
            <div class="form-group">
              <label class="form-label" data-i18n="optTestUrl"></label>
              <input type="text" id="testUrl" class="form-input" placeholder="https://example.com/img.jpg"/>
            </div>
            <button id="testRule" class="btn btn-secondary" data-i18n="optTestBtn"></button>
            <div id="testResult" class="test-result"></div>
          </div>
        </section>
      </div>

      <!-- 高级设置 -->
      <div id="advanced" class="tab-content">
        <section class="section">
          <h2 class="section-title" data-i18n="optAdvanced"></h2>
          <div class="form-group">
            <label class="form-label" data-i18n="optConcurrent"></label>
            <input type="number" id="concurrentDownloads" class="form-input" min="1" max="10" value="3"/>
            <p class="form-help" data-i18n="optConcurrentHelp"></p>
          </div>
          <div class="form-group">
            <label class="form-label" data-i18n="optDelay"></label>
            <input type="number" id="downloadDelay" class="form-input" min="0" max="5000" value="500"/>
            <p class="form-help" data-i18n="optDelayHelp"></p>
          </div>
          <div class="form-group">
            <label class="form-checkbox">
              <input type="checkbox" id="enableReferrer"/>
              <span class="checkmark"></span>
              <span data-i18n="optReferrer"></span>
            </label>
          </div>
          <div class="form-group">
            <label class="form-checkbox">
              <input type="checkbox" id="enableCustomHeaders"/>
              <span class="checkmark"></span>
              <span data-i18n="optCustomHdr"></span>
            </label>
          </div>
          <div id="customHeaders" class="custom-headers" style="display:none;">
            <label class="form-label" data-i18n="optHdrJson"></label>
            <textarea id="headersJson" class="form-textarea" rows="5" placeholder='{"User-Agent":"Mozilla/5.0..."}'></textarea>
          </div>
        </section>

        <section class="section">
          <h2 class="section-title" data-i18n="optDataMgmt"></h2>
          <div class="form-group">
            <button id="exportSettings" class="btn btn-secondary" data-i18n="optExport"></button>
            <button id="importSettings" class="btn btn-secondary" data-i18n="optImport"></button>
            <input type="file" id="importFile" accept=".json" style="display:none"/>
          </div>
          <div class="form-group">
            <button id="resetSettings" class="btn btn-danger" data-i18n="optReset"></button>
            <button id="clearHistory" class="btn btn-danger" data-i18n="optClearHist"></button>
          </div>
        </section>
      </div>

      <!-- 关于 -->
      <div id="about" class="tab-content">
        <section class="section">
          <div class="about-content">
            <img src="../icons/128.png" alt="Logo" class="about-logo"/>
            <h2 data-i18n="extName"></h2>
            <p class="version">v1.0.0</p>
            <p class="description" data-i18n="extDesc"></p>
            <div class="features">
              <h3 data-i18n="optFeatures"></h3>
              <ul>
                <li data-i18n="optFeat1"></li>
                <li data-i18n="optFeat2"></li>
                <li data-i18n="optFeat3"></li>
                <li data-i18n="optFeat4"></li>
                <li data-i18n="optFeat5"></li>
              </ul>
            </div>
            <div class="links">
              <a href="https://github.com/BiliBiliACEGE/web-image-downloader/blob/main/readme.md" id="helpLink" data-i18n="optHelp"></a>
              <a href="https://github.com/BiliBiliACEGE/web-image-downloader/issues" id="feedbackLink" data-i18n="optFeedback"></a>
              <a href="https://github.com/BiliBiliACEGE/web-image-downloader" id="rateLink" data-i18n="optRate"></a>
            </div>
          </div>
        </section>
      </div>
    </main>

        <!-- 规则编辑器模态框 -->
    <div id="ruleEditor" class="modal" style="display:none;">
      <div class="modal-content">
        <div class="modal-header">
          <h3 data-i18n="optEditRule"></h3>
          <button class="modal-close" id="closeEditor">&times;</button>
        </div>
        <form id="ruleForm" class="modal-body">
          <div class="form-group">
            <label data-i18n="optRuleDomain"></label>
            <input type="text" id="ruleDomain" class="form-input" placeholder="example.com">
          </div>
          <div class="form-group">
            <label data-i18n="optRulePattern"></label>
            <textarea id="rulePattern" class="form-textarea" rows="2" placeholder="正则表达式"></textarea>
          </div>
          <div class="form-group">
            <label data-i18n="optRuleReplacement"></label>
            <input type="text" id="ruleReplacement" class="form-input" placeholder="$1">
          </div>
          <div class="form-group">
            <label data-i18n="optRuleDesc"></label>
            <input type="text" id="ruleDesc" class="form-input" placeholder="简短描述（可选）">
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-primary" data-i18n="optSave"></button>
            <button type="button" class="btn btn-secondary" id="cancelRuleForm" data-i18n="optCancel"></button>
          </div>
        </form>
      </div>
    </div>

    <footer class="footer">
      <button id="saveSettings" class="btn btn-primary" data-i18n="optSave"></button>
      <button id="resetSettings" class="btn btn-secondary" data-i18n="optReset"></button>
    </footer>
  </div>
  <script src="options.js"></script>
</body>
</html>